{"version":3,"file":"jwt-login.umd.js","sources":["jwt-login.umd.js"],"sourcesContent":["import { html, PolymerElement } from \"@polymer/polymer/polymer-element.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\n/**\n * `jwt-login`\n * `a simple element to check for and fetch JWTs`\n * @demo demo/index.html\n * @microcopy - the mental model for this element\n * - jwt - a json web token which is an encrypted security token to talk\n */\nclass JwtLogin extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          visibility: hidden;\n        }\n      </style>\n      <iron-ajax\n        id=\"loginrequest\"\n        method=\"[[method]]\"\n        body=\"[[body]]\"\n        url=\"[[url]]\"\n        handle-as=\"json\"\n        content-type=\"application/json\"\n        on-response=\"loginResponse\"\n      >\n      </iron-ajax>\n    `;\n  }\n\n  static get tag() {\n    return \"jwt-login\";\n  }\n\n  static get properties() {\n    return {\n      /**\n       * url\n       */\n      url: {\n        type: String\n      },\n      /**\n       * Request method\n       */\n      method: {\n        type: String,\n        value: \"GET\"\n      },\n      /**\n       * Optional body, useful when doing posts\n       */\n      body: {\n        type: Object,\n        value: {}\n      },\n      /**\n       * Key that contains the token in local storage\n       */\n      key: {\n        type: String,\n        value: \"jwt\"\n      },\n      /**\n       * JSON Web token to securely pass around\n       */\n      jwt: {\n        type: String,\n        notify: true,\n        observer: \"_jwtChanged\"\n      }\n    };\n  }\n  _jwtChanged(newValue, oldValue) {\n    if (\n      (newValue == null || newValue == \"\") &&\n      typeof oldValue !== typeof undefined\n    ) {\n      // remove this key from local storage bin\n      localStorage.removeItem(this.key);\n      // jwt was invalid some how\n      this.dispatchEvent(\n        new CustomEvent(\"jwt-logged-in\", {\n          bubbles: true,\n          cancelable: true,\n          composed: true,\n          detail: false\n        })\n      );\n    } else if (newValue) {\n      // set the jwt into local storage so we can reference later\n      localStorage.setItem(this.key, newValue);\n      this.dispatchEvent(\n        new CustomEvent(\"jwt-token\", {\n          bubbles: true,\n          cancelable: true,\n          composed: true,\n          detail: newValue\n        })\n      );\n      this.dispatchEvent(\n        new CustomEvent(\"jwt-logged-in\", {\n          bubbles: true,\n          cancelable: true,\n          composed: true,\n          detail: true\n        })\n      );\n    }\n  }\n  /**\n   * Ready life cycle\n   */\n  ready() {\n    super.ready();\n    // set jwt from local storage bin\n    this.jwt = localStorage.getItem(this.key);\n  }\n  /**\n   * Request a user login if we need one or log out\n   */\n  toggleLogin() {\n    // null is default, if we don't have anything go get one\n    if (this.jwt == null) {\n      this.$.loginrequest.generateRequest();\n    } else {\n      // we were told to logout, reset body\n      this.set(\"body\", {});\n      // reset jwt which will do all the events / local storage work\n      this.jwt = null;\n    }\n  }\n  /**\n   * Login bridge to get a JWT and hang onto it\n   */\n  loginResponse(e) {\n    this.jwt = e.detail.response;\n  }\n}\nwindow.customElements.define(JwtLogin.tag, JwtLogin);\nexport { JwtLogin };\n"],"names":["JwtLogin","PolymerElement","html","url","type","String","method","value","body","Object","key","jwt","notify","observer","newValue","oldValue","_typeof","localStorage","setItem","this","dispatchEvent","CustomEvent","bubbles","cancelable","composed","detail","removeItem","getItem","$","loginrequest","generateRequest","set","e","response","window","customElements","define","tag"],"mappings":"48DASMA,gaAAiBC,+DAEZC,8CAoBA,qDAIA,CAILC,IAAK,CACHC,KAAMC,QAKRC,OAAQ,CACNF,KAAMC,OACNE,MAAO,OAKTC,KAAM,CACJJ,KAAMK,OACNF,MAAO,IAKTG,IAAK,CACHN,KAAMC,OACNE,MAAO,OAKTI,IAAK,CACHP,KAAMC,OACNO,QAAQ,EACRC,SAAU,yDAIJC,EAAUC,GAEL,MAAZD,GAAgC,IAAZA,iBACrBE,EAAOD,GAaED,IAETG,aAAaC,QAAQC,KAAKT,IAAKI,QAC1BM,cACH,IAAIC,YAAY,YAAa,CAC3BC,SAAS,EACTC,YAAY,EACZC,UAAU,EACVC,OAAQX,UAGPM,cACH,IAAIC,YAAY,gBAAiB,CAC/BC,SAAS,EACTC,YAAY,EACZC,UAAU,EACVC,QAAQ,OA1BZR,aAAaS,WAAWP,KAAKT,UAExBU,cACH,IAAIC,YAAY,gBAAiB,CAC/BC,SAAS,EACTC,YAAY,EACZC,UAAU,EACVC,QAAQ,qFA8BTd,IAAMM,aAAaU,QAAQR,KAAKT,2CAOrB,MAAZS,KAAKR,SACFiB,EAAEC,aAAaC,wBAGfC,IAAI,OAAQ,SAEZpB,IAAM,4CAMDqB,QACPrB,IAAMqB,EAAEP,OAAOQ,8CAGxBC,OAAOC,eAAeC,OAAOpC,EAASqC,IAAKrC"}